Suitable for .NET 8 or above
Run now! 
https://dotnetfiddle.net/NJltHw
